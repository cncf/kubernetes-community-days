{{ $isHome  := .IsHome }}
{{ $isEvent := and (eq .Section "events") (ne .CurrentSection .FirstSection) }}
{{ $home    := site.BaseURL }}
{{ $logo    := printf "admin/img/logos/%s" site.Params.logo | relURL }}
{{ $menu    := site.Menus.navbar }}
{{ $here    := .RelPermalink }}
{{ $section := .CurrentSection }}
{{ $url     := .RelPermalink }}
{{ $allowed := site.Params.allowed_event_pages }}
<nav class="navbar is-fixed-top{{ if not $isHome }} has-shadow{{ end }}">
  <div class="container">
    <div class="navbar-brand">
      {{ if not $isHome }}
      <a class="navbar-item" href="{{ $home }}">
        <img src="{{ $logo }}" alt="Kubernetes Community Days navbar logo">
      </a>
      {{ end }}
  
      <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
  
    <div id="navbar-menu" class="navbar-menu">
      <div class="navbar-end">
        {{ if $isEvent }}
        {{ with .CurrentSection }}
        {{ $isEventRoot := eq $url .RelPermalink }}
        <a class="navbar-item has-text-weight-bold{{ if $isEventRoot }} is-active{{ end }}" href="{{ .RelPermalink }}">
          Overview
        </a>

        {{ range .Pages }}
        {{ if and .Title (in $allowed .File.BaseFileName) }}
        {{ $isActive := eq $url .RelPermalink }}
        <a class="navbar-item has-text-weight-bold{{ if $isActive }} is-active{{ end }}" href="{{ .RelPermalink }}">
          {{ .Title }}
        </a>
        {{ end }}
        {{ end }}
        {{ end }}
        {{ end }}

        {{ range $menu }}
        {{ $isActive := hasPrefix $url .URL }}
        <a class="navbar-item has-text-weight-bold{{ if $isActive }} is-active{{ end }}" href="{{ .URL }}">
          {{ .Name }}
        </a>
        {{ end }}
      </div>
    </div>
  </div>
</nav>
